{{>partial_header}}

using System.Diagnostics.Metrics;

namespace {{packageName}}.Telemetry;

public class TelemetryCounters {
    // Meters
    // The total number of times a new token was requested when using ClientCredentials
    private const string TokenExchangeCountKey = "fga-client.credentials.request";

    protected Meter meter;
    public Counter<int> tokenExchangeCounter;

    public TelemetryCounters(Meter meter) {
        this.meter = meter;
        tokenExchangeCounter = this.meter.CreateCounter<int>(TokenExchangeCountKey,
            description: "The count of token exchange requests");
    }

    public void buildForResponse(KeyValuePair<string, object>[] attributes) => tokenExchangeCounter.Add(1, attributes!);
}